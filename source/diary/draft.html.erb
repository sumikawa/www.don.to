---
title: Drafts
---
<%
index = []
Dir.glob("source/diary/*/[01]*.html.md.erb").each do |filename|
  header = YAML.load_file(filename)
  if header['draft']
    index << gen_link(filename, header['title'] || data.site.notitle, true)
  end
end
%>
<dl>
  <%= index.sort.reverse.join("\n") %>
</dl>

<%
d1 = []
d2 = []
for year in (thisyear - 1)..(thisyear)
  Dir.glob(File.expand_path("#{data.site.imagerootdir}/diary/#{year}/*")).each do |dirname|
    d1 << "#{year}/#{File.basename(dirname)}"
  end
  FileUtils.mkdir_p("source/diary/#{year}")
  Dir.glob(File.expand_path("source/diary/#{year}/*")).each do |dirname|
    d2 << "#{year}/#{File.basename(dirname)}".sub(/\.html\.md\.erb/, '')
  end
end
d = d1 - d2
%>

<% if d.any? %>
  <dl>
    <% d.each do |dir| %>
      <% gen_index dir %>
      <dt><%= "#{dir}.html.md.erb... generated" %></dt>
    <% end %>
  </dl>
<% end %>
